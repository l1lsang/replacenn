<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì—°ì† ì¤„ë°”ê¿ˆ ì œê±°ê¸°</title>
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--accent:#60a5fa;--muted:#94a3b8;color-scheme:dark}
    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;color:#e6eef8;background:linear-gradient(180deg,#071025 0%, #071428 100%);}
    .wrap{max-width:980px;margin:28px auto;padding:20px;}
    header{display:flex;align-items:center;gap:16px;margin-bottom:14px}
    h1{font-size:20px;margin:0}
    p.subtitle{margin:0;color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    textarea{width:100%;height:320px;padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:#e6eef8;resize:vertical;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;}
    .controls{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:10px}
    .row{display:flex;gap:8px;align-items:center}
    label{font-size:13px;color:var(--muted)}
    input[type=number]{width:68px;padding:6px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .btns{display:flex;gap:8px;margin-top:6px}
    button{background:var(--accent);border:none;padding:8px 12px;border-radius:8px;color:#04122a;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .meta{font-size:13px;color:var(--muted);display:flex;gap:14px;align-items:center}
    footer{margin-top:14px;color:var(--muted);font-size:13px;text-align:center}
    @media (max-width:880px){.grid{grid-template-columns:1fr;}.wrap{padding:12px}} 
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>ì—°ì† ì¤„ë°”ê¿ˆ ì œê±°ê¸° â€” ì›¹ ë²„ì „ âœ¨</h1>
        <p class="subtitle">ì—¬ëŸ¬ ì¤„ì˜ ë¹ˆ ì¤„(ë˜ëŠ” ì—°ì† ì¤„ë°”ê¿ˆ)ì„ í•œ ë²ˆì— ì •ë¦¬í•´ì¤ë‹ˆë‹¤. ê°„ë‹¨í•˜ê³  ë¹ ë¥´ê²Œ ì²˜ë¦¬í•´ë³´ì„¸ìš”.</p>
      </div>
    </header>

    <div class="grid">
      <div>
        <label for="input">ì›ë³¸ í…ìŠ¤íŠ¸</label>
        <textarea id="input" placeholder="ì—¬ê¸°ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”..."></textarea>

        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
          <div class="meta">
            <span id="chars">ë¬¸ì: 0</span>
            <span id="lines">í–‰: 0</span>
          </div>
          <div style="display:flex;gap:8px">
            <button id="clear" class="ghost">ì§€ìš°ê¸°</button>
            <button id="process">ì •ë¦¬í•˜ê¸° (Ctrl+Enter)</button>
          </div>
        </div>
      </div>

      <div>
        <div class="controls">
          <div class="row">
            <input type="checkbox" id="normalize" checked />
            <label for="normalize">CRLF(\\r\\n)ë¥¼ LF(\\n)ë¡œ ë³€í™˜</label>
          </div>

          <div class="row">
            <input type="checkbox" id="trim" />
            <label for="trim">ì•/ë’¤ì˜ ê³µë°± ì¤„ ì œê±°</label>
          </div>

          <div class="row">
            <input type="checkbox" id="collapse" checked />
            <label for="collapse">ì—°ì† ì¤„ë°”ê¿ˆì„ ì¶•ì•½ (ì•„ë˜ ìˆ«ìë§Œí¼ ìœ ì§€)</label>
          </div>

          <div class="row">
            <label for="max">ìµœëŒ€ ì—°ì† ì¤„ë°”ê¿ˆ ìˆ˜</label>
            <input id="max" type="number" min="1" value="1" />
            <span style="color:var(--muted);font-size:13px">(1ì´ë©´ ì—°ì† ì¤„ë°”ê¿ˆì„ í•œ ì¤„ë¡œ ì¶•ì•½)</span>
          </div>

          <div style="display:flex;gap:8px;align-items:center">
            <button id="copy" class="ghost">ë³µì‚¬</button>
            <button id="download" class="ghost">ë‹¤ìš´ë¡œë“œ</button>
            <button id="previewToggle" class="ghost">ë¯¸ë¦¬ë³´ê¸° í† ê¸€</button>
          </div>

          <div style="font-size:13px;color:var(--muted)">ë‹¨ì¶•í‚¤: <strong>Ctrl+Enter</strong>ë¡œ ì²˜ë¦¬</div>
        </div>

        <div style="margin-top:10px;display:flex;flex-direction:column;gap:8px">
          <label for="output">ê²°ê³¼</label>
          <textarea id="output" readonly placeholder="ì •ë¦¬ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
        </div>
      </div>
    </div>

    <footer>ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸: ì—¬ëŸ¬ ì¤„ì„ ë¶™ì—¬ë„£ê³  ì •ë¦¬í•˜ê¸°ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”. í•„ìš”í•˜ë©´ ì˜µì…˜ì„ ë°”ê¿”ì„œ ì‹¤í—˜í•´ë„ ì¢‹ì•„ìš” ğŸ˜Š</footer>
  </div>

  <script>
    const input = document.getElementById('input');
    const output = document.getElementById('output');
    const chars = document.getElementById('chars');
    const lines = document.getElementById('lines');
    const processBtn = document.getElementById('process');
    const clearBtn = document.getElementById('clear');
    const copyBtn = document.getElementById('copy');
    const downloadBtn = document.getElementById('download');
    const normalizeChk = document.getElementById('normalize');
    const trimChk = document.getElementById('trim');
    const collapseChk = document.getElementById('collapse');
    const maxInput = document.getElementById('max');

    function updateMeta(){
      const v = input.value;
      chars.textContent = 'ë¬¸ì: ' + v.length;
      lines.textContent = 'í–‰: ' + (v === '' ? 0 : v.split(/\\r?\\n/).length);
    }

    function processText(){
      let t = input.value;
      if(normalizeChk.checked){
        // ëª¨ë“  CRLF -> LF
        t = t.replace(/\\r\\n/g,'\\n').replace(/\\r/g,'\\n');
      }

      // í…ìŠ¤íŠ¸ ì•ˆì˜ "\\n" ë¬¸ìì—´ì„ ì‹¤ì œ ì¤„ë°”ê¿ˆìœ¼ë¡œ ë³€í™˜
      t = t.replace(/\\\\n/g, '\n');

      if(trimChk.checked){
        // ì•ê³¼ ë’¤ì˜ ë¹ˆ ì¤„(ê³µë°±+ì¤„ë°”ê¿ˆ) ì œê±°
        t = t.replace(/^\s*\n+/, '');
        t = t.replace(/\n+\s*$/, '');
      }

      if(collapseChk.checked){
        const max = Math.max(1, parseInt(maxInput.value) || 1);
        const repl = '\n'.repeat(max);
        t = t.replace(/(\n\s*){2,}/g, repl);
      }

      output.value = t;
      try{navigator.clipboard && (copyBtn.disabled = false);}catch(e){}
      return t;
    }

    input.addEventListener('input', updateMeta);
    processBtn.addEventListener('click', ()=>{ processText(); updateMeta(); });
    clearBtn.addEventListener('click', ()=>{ input.value=''; output.value=''; updateMeta(); });

    copyBtn.addEventListener('click', async ()=>{
      try{
        await navigator.clipboard.writeText(output.value);
        copyBtn.textContent = 'ë³µì‚¬ë¨!';
        setTimeout(()=> copyBtn.textContent='ë³µì‚¬',900);
      }catch(e){
        alert('ë¸Œë¼ìš°ì €ê°€ ë³µì‚¬ ê¶Œí•œì„ í—ˆìš©í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
      }
    });

    downloadBtn.addEventListener('click', ()=>{
      const blob = new Blob([output.value], {type:'text/plain;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'cleaned.txt';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    document.addEventListener('keydown', (e)=>{
      if((e.ctrlKey || e.metaKey) && e.key === 'Enter'){
        e.preventDefault();
        processBtn.click();
      }
    });

    updateMeta();
  </script>
</body>
</html>
